# 本文介绍TCP/IP协议先关内容

## 1.网络基础知识

-   OSI参考模型：==物理层== -> ==数据链路层== -> ==网络层== -> ==传输层== -> ==会话层== -> ==表示层== -> ==应用层==
-   OSI协议以OSI参考模型为基础界定了每个阶层的协议和每个阶层之间接口相关的标准；
    -   7.应用层：针对特定应用，如电子邮件，远程登录，文件传输；
    -   6.表示层：设备固有数据格式与网络标准数据格式的转换；
    -   5.会话层：通信管理。负责建立和断开通信连接；
    -   4.传输层：管理两个节点之间的数据传输。负责可靠传输；
    -   3.网络层：地址管理与路由选择；
    -   2.数据链路层：互联设备之间传送和识别数据帧。
    -   1.物理层：物理接口，连接器；
-   TCP/IP 分层：==物理层==（以太网，无线LAN，PPP，）-->  ==网络层==（ARP，IPv4 ，IPVC6 ，ICMP）--> ==传输层== （TCP, UDP...） --> ==应用层==（SSH,HTTP,SMTP,POP)
-   WAN(Wide Area Nerwork, 广域网)
-   LAN（Local Area Nerwork，局域网）
-   传输方式：面向有连接与面向无连接型；
-   单播和广播：
    -   单播：就是1对1通信；
    -   广播：1对多
    -   多播：与广播类似，也是将消息发送给多个接收主机，不同之处在于多播要限定某一组主机作为接收端。虽然一对多，但是限定多是谁；例如电视会议；
    -   任播：特定的多台主机中选出一台作为接收端的一种通信方式；面向多个，但最终选择单个特定主机通信；如DNS；
-   地址：每一层协议所使用的地址不尽相同；例如MAC地址，IP地址，端口号，等；
-   网络设备：
    -   网卡：使计算机联网的设备，也叫网卡，LAN卡；
    -   网桥：从数据链路层上延长网络的设备；
    -   路由：通过网络层转发分组数据的设备；
    -   交换机器：处理传输层以上各层网络传输的设备；
-   云：利用虚拟化技术，根据需要自动进行动态管理分配计算机资源（存储，CPU，内存等）

## 2.TCP/IP 基础

-   RFC（Request For Comment）文档，记录协议规范内容；http://www.rfc-editor.org/rfc/   ftp://ftp.rfc-deitor.org/in-notes/
-   The Internet：互联网
-   TCP/IP 的分层模型：
    -   物理层和网络接口层：网卡及接口；
    -   网络层：IP，ICMP，ARP
    -   传输层：TCP，UDP
    -   应用层：HTTP(HyperText Transfer Protocol),FTP(File Transfer Prototol),SSH...
-   每个分层中，都会对所发送的数据附加一个首部，在这个首部中包含了该层必要的信息；


## 3.数据链路

数据链路层的协议定义了通过通信媒介互联的设备之间传输的规范。

-   MAC地址：用于识别数据链路中互联的节点；
-   以太网：Ethernet，
-   VPN:(虚拟专用网络)

## 4.IP协议

网络层协议，主要作用是“实现终端节点之间的通信”。

-   主机：一般将配有IP地址，但不进行路由控制的设备；
-   路由：即配有IP地址，又具有路由控制能力的设备叫做“路由器”
-   节点：路由和主机的统称；
-   路由控制（routing）：指将分组数据发送到最终目标地址的功能；
-   Hop：跳，指网络中的一个区间；一跳指利用数据链路层以下分层的功能传输数据帧的一个区间；
-   路由控制表：Routing Table，
-   IP属于面向无连接型：原因有两点，一是为了提速，二是为了简化；
-   IP地址由==网络和主机==两部分标识组成；相同段内相连的主机必须有相同的网络地址，IP地址的主机标识则不允许在同一个网段内重复出现；
-   广播地址：==将主机为全部改为1==
    -   本地广播：在本网内的广播叫做本地广播，
    -   直接广播：不同网络间的广播；叫做直接广播；
-   IP多播：用于将包发送给特定组内的所有主机，多播使用D类地址，开始四位是“1110”就可以认为是多播地址；`224.xxx.xxx.xxx`
-   子网掩码：IP地址==网络部分全部为1==，对应IP地址==主机部分全部为0==；
-   生存时间：TTL，指可以中转多少个路由器，经过一个TTL减1，直到为0丢弃；
-   DNS Domain Name System，主机名和IP的对应；
-   查询过程：向默认的DNS服务器发起查询，知道与否？向顶级域名服务器查询，返回；
-   DHCP：（Dynamic Host Configuration Protocol）即插即用，自动分配IP；


## 5.TCP与UDP

-   TCP：Transmission Control Protocol;是面向连接的、可靠的流协议。流就是不间断的数据结构，TCP为提供可靠性传输，实行“顺序控制”或重发控制；此外还具有流量控制，拥塞控制、提高网络利用率等众多功能；
-   UDP：User Datagram Protocol;UDP是不具有可靠性的数据报协议。可以确保发送消息的大小，不能保证消息一定会到达；
-   TCP与UDP区别：TCP用于在传输层有必要实现可靠传输的情况，UDP主要用于那些对高速传输和实时性有较高要求的通信或广播通信；如IP电话；
-   端口号：数据链路和IP中的地址，分别指MAC地址和IP地址，前者用来识别同一链路中不同的计算机，后者用来识别TCP/IP网络中互联的主机和路由；在传输层中也有类似地址的概念，用以区分不能程序，成为端口号；
-   TCP/IP或UDP/IP 通信中通常采用5个信息来识别一个通信；它们是“源IP地址”、"目标IP地址"、"协议号"、"源端口号"、"目标端口号"；
-   端口号的确定：1.标准既定的端口号，一般是0-1023，具有特定用途；此外还有一些被正式注册，分布在2104-49151的数字之间；2.时序分配，交由操作系统动态管理，取值范围49152-65535之间；
-   不同的协议可以使用相同的端口号；

### UDP

-   特点：不提供复杂的控制机制；无丢包重传机制，面向无连接，简单高效；
-   应用：
    -   1.包总量较少的通信（DNS,SNMP等）；
    -   2.视频、音频等多媒体通信（即时通信）；
    -   3.限定LAN等特定网络中的应用通信；
    -   4.广播通信（广播，多播）；

### TCP

-   特点：对传输、发送、通信进行控制的协议；可以进行丢包时的重发控制，对次序乱掉的分包进行顺序控制；
-   通过==检验和，序列号，确认应答，重发控制，连接管理，以及窗口控制等机制实现可靠性传输==；
-   序列号：按顺序给发送数据的每个字节都标记上号码的编号；
-   确认应答：发送端的数据到达接收主机时，接收主机会返回一个已经收到消息的通知；这个消息叫确认应答；应答号为需要接收的下个数据号；
-   连接：TCP数据通信前或通过TCP首部发送一个`SYN`包作为建立连接的请求等待确认应答；需要三次；
-   断开：需要四次；请求切断，应答、请求切断，应答；
-   TCP以段为单位发送数据：称为MSS，Maximum Segment Size，最大消息长度；在连接建立时确定，取通信双方最小的；
-   窗口：无需等待确认应答而可以继续发送数据的最大值；
-   滑动窗口：收到确认应答，==将窗口滑动到确认应答中的序列号的位置==；
-   窗口在一定程度上保证，即使有少部分确认应答丢失也不会进行数据重发；（可以通过后面的应答，确认）
-   三次应答重发：如果收到三次重复应答，则将其后面的一段数据重发；
-   流控制：


